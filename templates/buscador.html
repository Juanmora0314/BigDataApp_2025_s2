{% extends "base.html" %}

{% block title %}Buscador de normatividad 路 MinMinas 路 BigData{% endblock %}

{% block content %}
<div class="mb-4">
  <h1>Buscador de normatividad</h1>
  <p class="text-muted">
    Escribe palabras clave relacionadas con la norma que deseas consultar.
  </p>
</div>

<div class="search-card mb-4">
  <form method="get" action="{{ url_for('buscador') }}" class="row g-2 align-items-center">
    <div class="col-md-9">
      <input
        type="text"
        class="form-control form-control-lg"
        name="q"
        placeholder="Ej. regal铆as, hidrocarburos, transici贸n energ茅tica..."
        value="{{ query or '' }}"
        required
      >
    </div>
    <div class="col-md-3 d-grid">
      <button class="btn btn-primary btn-lg" type="submit">
         Buscar
      </button>
    </div>
  </form>
</div>

{% if error_msg %}
  <div class="alert alert-danger">{{ error_msg }}</div>
{% endif %}

{% if query and resultados %}
  <h5 class="mb-3">
    Resultados para: "<span class="fw-semibold">{{ query }}</span>"
  </h5>
  <span class="badge bg-secondary mb-3">
    {{ resultados|length }} documento(s) encontrado(s)
  </span>

  <div class="list-group">
    {% for r in resultados %}
      <div class="result-item">
        <div class="fw-semibold">
          {{ r.titulo or "Sin t铆tulo" }}
        </div>
        <div class="result-meta">
          <strong>Entidad:</strong> {{ r.entidad or "N/D" }}
          &nbsp;路&nbsp;
          <strong>A帽o:</strong> {{ r.anio or "N/D" }}
          &nbsp;路&nbsp;
          <strong>Tipo:</strong> {{ r.tipo or "N/D" }}
          &nbsp;路&nbsp;
          <span class="text-muted">score: {{ "%.2f"|format(r.score or 0) }}</span>
        </div>
      </div>
    {% endfor %}
  </div>
{% elif query and not resultados and not error_msg %}
  <p class="text-muted">No se encontraron documentos para esa b煤squeda.</p>
{% endif %}
{% endblock %}
